/* Shield UI 1.7.27 Trial Version | Copyright 2013-2016 Shield UI Ltd. | http://www.shieldui.com/eula */
!function(a,b,U,e){var z,t,u=b.ui.Widget,p=(b.Class,document),c=a.proxy,O=a.each,J=(a.extend,a.map),T=Math.min,Q=Math.max,R=(b.guid,b.iid),S=b.error,K=b.format,q=b.is.defined,d=(b.is["boolean"],b.is.integer,b.is.func,b.is.array,b.is.object,b.is.string,b.support.browser,"disabled"),k="multiple",A="change",C="dragover",E="dragleave",n="drop",G="select",y="remove",P="click",l="error",B="progress",L="abort",D="load",v="upload",I="complete",w="POST",j="pending",H="uploading",i="complete",F="removing",h="error",M={pending:"&#10005;",uploading:"&#10754;",complete:"&#10005;",removing:"&#10754;",error:"&#10005;"},N="shieldUploadIframe",f="sui-upload",o=f+"-target-input",x=f+"-status",s=f+"-file",g=f+"-xhr",r=f+"-form",m=f+"-iframe";z={cls:e,enabled:!0,async:{enabled:!1,autoUpload:!1,batch:!1,save:{url:e,field:e},remove:{url:e,field:"fileNames",method:w}},multiple:!0,files:{enabled:!0,initial:e,template:"{name} ({size} bytes)"},messages:{drop:"Drop files here to upload",select:"Select files ...",upload:"Upload files"},events:{}},t=u.extend({init:function(){u.fn.init.apply(this,arguments);var s,l,e,h,j,w,g,b=this,f=b.options,v=f.dieOnError,r=f.cls,o=f.messages,t=f.files,q=t.enabled,m=t.initial,x=f.async.enabled;return b._xhr2support=s=!!(new XMLHttpRequest).upload,b._original=e=a(b.element),"input"!=e.prop("tagName").toLowerCase()||"file"!=e.attr("type").toLowerCase()?void S("shieldUpload: Must be initialized from an input with type file.",v):(g=b._eventNS=".shieldUpload"+b.getInstanceId(),e.wrap("<form>").closest("form").get(0).reset(),e.unwrap(),e.removeAttr(d),f.multiple?e.attr(k,k):e.removeAttr(k),b.element=l=e.wrap("<div/>").parent(),l.addClass("sui-upload"+(r?" "+r:"")),b._selectButtonDiv=e.wrap("<div/>").parent().append('<span class="sui-upload-button-text">'+o.select+"</span>").addClass("sui-upload-button"),b._dropFilesDiv=h=b._selectButtonDiv.wrap('<div class="sui-upload-dropfiles"/>').parent(),b._dropText=j=a('<div class="sui-upload-drop">'+o.drop+"</div>").appendTo(h).hide(),q&&(b._fileList=w=a('<ul class="sui-upload-files"/>').appendTo(l).hide()),b._uploadButtonDiv=a('<button class="sui-upload-button sui-upload-button-upload" type="button">'+o.upload+"</button>").appendTo(l).click(c(b._uploadClicked,b)).hide(),e.on(A+g,c(b._fileSelected,b)),x&&s&&(e.on(n+g,c(b._fileChanged,b)),a(p).on(C+g,function(a){a.stopPropagation(),a.preventDefault(),j.show()}).on(E+g,function(a){a.stopPropagation(),a.preventDefault(),j.hide()}).on(n+g,function(a){a.stopPropagation(),a.preventDefault(),j.hide()}),h.on(C,function(){h.addClass("sui-upload-dropfiles-hover")}).on(E,function(){h.removeClass("sui-upload-dropfiles-hover")}).on(n,c(b._fileChanged,b))),q&&m&&m.length>0&&b._addFiles(m,i),void b.enabled(f.enabled))},refresh:function(a){this.refreshWithElement(this._original,a)},_getFiles:function(c){var d,b=[],e=a(c.target);return c.originalEvent.dataTransfer&&c.originalEvent.dataTransfer.files?b=c.originalEvent.dataTransfer.files:c.target.files?b=c.target.files:(b=a.makeArray(e.prop("files")),b.length?!q(b[0].name)&&b[0].fileName&&O(b,function(b,a){a.name=a.fileName,a.size=a.fileSize}):(d=e.prop("value"),b=d?[{name:d.replace(/^.*\\/,"")}]:[])),b},_getPendingFileItems:function(){return a(this._fileList).children("li.sui-upload-file-"+j)},_getFileInfoList:function(b){return this._toFileInfoList(a(b).data(s))},_toFileInfoList:function(a){var b,d=this,c=[];if(d._isSingleFile(a))c.push(a);else if(d._isFileList(a))for(b=0;b<a.length;b++)c.push(a[b]);return c},_isSingleFile:function(a){return a&&a.name},_isFileList:function(a){return a.length&&a.length>0},_fileSelected:function(f){var e,g,b=this,h=b.options,m=h.async.enabled,o=b._xhr2support,i=b._eventNS,d=a(f.target),l=b._getFiles(f);g=b.trigger(G,{files:b._toFileInfoList(l)}),g.isDefaultPrevented()||(e=a('<input type="file" name="'+d.attr("name")+'"/>').insertAfter(d).on(A+i,c(b._fileSelected,b)),h.multiple&&e.attr(k,k),m&&o&&e.on(n+i,c(b._fileChanged,b)),d.hide(),b._addFiles(l,j,d))},_fileChanged:function(b){var c,a=this,d=a._getFiles(b);b.stopPropagation(),b.preventDefault(),a._dropText.hide(),a._dropFilesDiv.removeClass("sui-upload-dropfiles-hover"),c=a.trigger(G,{files:a._toFileInfoList(d)}),c.isDefaultPrevented()||a._addFiles(d,j)},_addFiles:function(c,f,g){var b,a=this,d=a.options,e=d.async;if(d.files.enabled){if(e.enabled&&!e.batch||!d.multiple)for(b=0;b<c.length;b++)a._renderFile(c[b],f,g);else a._renderFile(c,f,g);a._afterAddRemoveFiles(),e.autoUpload&&a._uploadAllPending()}},_renderFile:function(h,j,k){var d,e,b=this,l=b.options,m=l.files.template,g=(b._fileList,b._toFileInfoList(h)),f=[];for(d=a('<li class="sui-upload-file"/>').data(s,h).appendTo(b._fileList),k&&d.data(o,k),e=0;e<g.length;e++)f.push(a('<span class="sui-upload-file-text"/>').append(K(m,g[e]))),e<g.length-1&&f.push(a('<span class="sui-upload-file-text-sep">,</span>'));l.async.enabled&&b._xhr2support?f.push(a('<span class="sui-upload-file-progress"/>')):d.addClass("sui-upload-file-no-progress"),f.push(a('<span class="sui-upload-file-action"/>').on(P,c(b._actionClicked,b,d))),d.append(f),b._setStatus(d,j),j===i&&b._setProgress(d,100)},_afterAddRemoveFiles:function(){var a=this,c=a.options.async,b=a._fileList,d=a._uploadButtonDiv;b.children("li").length>0?b.show():b.hide(),a._getPendingFileItems().length>0?c.enabled&&!c.autoUpload&&d.show():d.hide()},_actionClicked:function(b,c){var a=this,d=a._getStatus(b);a._enabled&&(d==H?a._abortUpload(b,c):d==F?a._abortRemove(b,c):a._removeItem(b,c))},_removeItem:function(c,p){var e,n,b=this,q=(b.options,b.options.async),g=q.remove,f=b._getStatus(c),m=b._getFileInfoList(c),k=c.data(o),r=b._eventNS,s={};n=b.trigger(y,{domEvent:p,status:f,files:m}),n.isDefaultPrevented()||(e=function(){a(k)[0]===a(b._original)[0]?a(k).hide().attr(d,d):a(k).off(r).remove(),a(c).off(r).remove(),b._afterAddRemoveFiles()},f==j||f==h?e():f==i&&(q.enabled?(b._setStatus(c,F),s[g.field]=J(m,function(a){return a.name}),a.support.cors=!0,a.ajax({method:g.method,url:g.url,traditional:!0,data:s}).done(function(a,b,c){e()}).fail(function(d,e,a){b.trigger(l,{domEvent:p,operation:y,listItem:c,files:m,jqXHR:d,textStatus:e,errorThrown:a,responseText:a});n.isDefaultPrevented()||b._setStatus(c,h)})):e()))},_abortRemove:function(a,b){},_setStatus:function(c,b){a(c).data(x,b).removeClass("sui-upload-file-pending sui-upload-file-uploading sui-upload-file-complete sui-upload-file-removing sui-upload-file-error").addClass("sui-upload-file-"+b).children(".sui-upload-file-action").first().html(M[b]),this._afterAddRemoveFiles()},_getStatus:function(b){return a(b).data(x)},_uploadAllPending:function(){var d,h,b,c=this,i=c.options,f=(i.async,c._getPendingFileItems()),g=(f||[]).length,e=[];if(!(1>g)){for(b=0;g>b;b++)d=a(f[b]).data(s),c._isSingleFile(d)?e.push(d):c._isFileList(d)&&(e=e.concat(d));if(h=c.trigger(v,{files:e}),!h.isDefaultPrevented())for(b=0;g>b;b++)c._startUpload(f[b])}},_startUpload:function(d){var k,n,e,h,i,j,f,b=this,v=b.options,x=v.async,s=x.save,t=s.field,u=b._getFileInfoList(d);if(q(t)||(t=a(b._original).attr("name")),b._setProgress(d,0),b._xhr2support){for(n=new FormData,e=new XMLHttpRequest,f=0;f<u.length;f++)n.append(t,u[f]);a(d).data(g,e),e.open(w,s.url),e.upload.addEventListener(B,c(b._onUploadProgress,b,d)),e.upload.addEventListener(D,c(b._onUploadComplete,b,d)),e.upload.addEventListener(l,c(b._onUploadError,b,d)),e.onreadystatechange=function(){4==e.readyState&&200!=e.status&&b._onUploadError(d)},e.send(n)}else k=a(d).data(o),k&&(h=N+R(),i=a('<iframe name="'+h+'" id="'+h+'" class="sui-upload-iframe" width="0" height="0" tabindex="-1"/>').appendTo(p.body),a(i).on(D,c(b._onIframeComplete,b,d)),j=a('<form class="sui-upload-form" method="'+w+'" enctype="multipart/form-data" action="'+s.url+'" target="'+h+'" tabindex="-1"/>').appendTo(p.body).append(k),a(d).data(m,i).data(r,j),j.get(0).submit());b._setStatus(d,H)},_abortUpload:function(b,e){var d,c=this;c._xhr2support?(d=a(b).data(g),d&&d.abort(),a(b).removeData(g)):c._cleanupIframeForm(b),c._setStatus(b,j),c._setProgress(b,0),c.trigger(L,{listItem:b,files:c._getFileInfoList(b)})},_cleanupIframeForm:function(b){var f=this,c=a(b).data(m),d=a(b).data(r),e=a(b).data(o);c&&a(c).attr("src","about:blank"),d&&(e&&a(e).prependTo(f._selectButtonDiv),a(d).remove(),a(b).removeData(r)),c&&(a(c).remove(),a(b).removeData(m))},_setProgress:function(c,d){var b=a(c).children(".sui-upload-file-progress").first();b&&b.length>0&&b.empty().append(a('<span class="sui-upload-file-progress-inner"/>').css("width",d+"%"))},_onUploadProgress:function(b,a){var c=this,d=a.lengthComputable?T(100,Q(0,a.loaded/a.total*100)):e;q(d)&&c._setProgress(b,d),c.trigger(B,{domEvent:a,percentage:d,listItem:b,files:c._getFileInfoList(b)})},_onUploadComplete:function(b){var c=this;c._setStatus(b,i),c._setProgress(b,100),a(b).removeData(g),c.trigger(I,{listItem:b,files:c._getFileInfoList(b)})},_onIframeComplete:function(b,n){var g,c=this,j=a(b).data(m),k=c._getFileInfoList(b),d="";if(j){try{d=a(j).contents().find("body").html()}catch(f){d=f?f.description||f.message:""}d?(g=c.trigger(l,{domEvent:n,operation:v,listItem:b,files:k,status:e,responseText:d}),g.isDefaultPrevented()||(c._setStatus(b,h),c._setProgress(b,0))):(c._setStatus(b,i),c._setProgress(b,100),c.trigger(I,{listItem:b,files:k})),c._cleanupIframeForm(b)}},_onUploadError:function(b,j){var k,e,f,m,i,c=this,n=c._getStatus(b),d=a(b).data(g);n!==h&&(d&&(k=d.readyState,e=d.status,f=d.responseText,m=d.statusText),a(b).removeData(g),i=c.trigger(l,{domEvent:j,operation:v,listItem:b,files:c._getFileInfoList(b),status:e,responseText:f}),i.isDefaultPrevented()||(c._setStatus(b,h),c._setProgress(b,0)))},_uploadClicked:function(b){var a=this;a._enabled&&a._uploadAllPending()},enabled:function(){var b,c,e=this,f=a(e.element),g=[].slice.call(arguments);return g.length>0?(b=!!g[0],c=f.find('input[type="file"]').filter(":visible"),b?(f.removeAttr(d).removeClass("sui-upload-disabled"),a(c).removeAttr(d)):(f.attr(d,d).addClass("sui-upload-disabled"),a(c).attr(d,d)),e._enabled=b,void 0):e._enabled},destroy:function(){var b=this,e=a(b.element),c=a(b._original),f=b._eventNS;a(p).off(f),a(e).find('input[type="file"]').off(f),a(e).find('input[type="file"]').not(c).remove(),b._uploadButtonDiv&&(a(b._uploadButtonDiv).remove(),b._uploadButtonDiv=null),b._dropText&&(a(b._dropText).remove(),b._dropText=null),b._fileList&&(a(b._fileList).remove(),b._fileList=null),a(e).find(".sui-upload-button-text").remove(),a(c).unwrap(),a(c).unwrap(),a(c).unwrap(),b._selectButtonDiv=b._dropFilesDiv=null,a(c).removeAttr(d).show(),u.fn.destroy.call(b)}}),t.defaults=z,b.ui.plugin("Upload",t)}(jQuery,shield,this);