/* Shield UI 1.7.27 Trial Version | Copyright 2013-2016 Shield UI Ltd. | http://www.shieldui.com/eula */
!function(b,c,w,e){var v,o,a,d,u,q,t,l=c.ui.Widget,r=c.Class,A=c.DataSource,B=(document,Math.abs,Math.min),y=Math.max,j=Math.pow,i=(Math.floor,b.proxy),h=(b.each,b.map,c.format),z=c.to["int"],s=c.error,g=c.is,k=g.defined,x=(g.string,g.object,g.func,c.to.number,"squarified"),f="horizontal",n="vertical",p="click",m="disabled";a=r.extend({init:function(b,c,d,e){var a=this;a.left=b,a.top=c,a.width=d,a.height=e},getSize:function(){return B(this.width,this.height)},getRowContainers:function(b){var a,c=this,d=c.left,e=c.top,i=c.sum(b),f=i/c.height,g=i/c.width,h=[];if(c.width>=c.height)for(a=0;a<b.length;a++)h.push({left:d,top:e,right:d+f,bottom:e+b[a].targetValue/f,dataItem:b[a]}),e+=b[a].targetValue/f;else for(a=0;a<b.length;a++)h.push({left:d,top:e,right:d+b[a].targetValue/g,bottom:e+g,dataItem:b[a]}),d+=b[a].targetValue/g;return h},remainingArea:function(f){var c,d,g,h,e,b=this;return b.width>=b.height?(c=f/b.height,g=b.width-c,e=new a(b.left+c,b.top,g,b.height)):(d=f/b.width,h=b.height-d,e=new a(b.left,b.top+d,b.width,h)),e},sum:function(b){var a,c=0;for(a=0;a<b.length;a++)c+=b[a].targetValue;return c}}),d=r.extend({init:function(){},sort:function(a){a.sort(function(a,b){return b.targetValue-a.targetValue})},sum:function(b){var a,c=0;for(a=0;a<b.length;a++)c+=b[a].targetValue;return c},min:function(c){var a,b=e;for(a=0;a<c.length;a++)(!k(b)||b>c[a].targetValue)&&(b=c[a].targetValue);return b},max:function(c){var a,b=e;for(a=0;a<c.length;a++)(!k(b)||b<c[a].targetValue)&&(b=c[a].targetValue);return b}}),d.create=function(a){return a===x?new t:a===f?new u:new q},u=d.extend({init:function(){d.fn.init.apply(this,arguments)},execute:function(j,d,r,g,q){var h,i,b,e,c,k,m=this,s=m.sum(j),o=d.left,p=d.top,l=!q||q===f;for(m.sort(j),k=0;k<j.length;k++)b=j[k],h=l?d.width*b.targetValue/s:d.width,i=l?d.height:d.height*b.targetValue/s,b.items&&0!==b.items.length?(e=g.createGroup(r,new a(o,p,h,i)),c=g.createTitle(e,g.getItemText(b)),c=new a(c.left-e.position().left,c.top-e.position().top,c.width,c.height),m.execute(b.items,c,e,g,l?n:f)):g.createItem(r,{left:o,top:p,width:h,height:i,dataItem:b}),l?o+=h:p+=i}}),q=d.extend({init:function(){d.fn.init.apply(this,arguments)},execute:function(j,d,r,g,q){var h,i,b,e,c,k,m=this,s=m.sum(j),o=d.left,p=d.top,l=!q||q===n;for(m.sort(j),k=0;k<j.length;k++)b=j[k],i=l?d.height*b.targetValue/s:d.height,h=l?d.width:d.width*b.targetValue/s,b.items&&0!==b.items.length?(e=g.createGroup(r,new a(o,p,h,i)),c=g.createTitle(e,g.getItemText(b)),c=new a(c.left-e.position().left,c.top-e.position().top,c.width,c.height),m.execute(b.items,c,e,g,l?f:n)):g.createItem(r,{left:o,top:p,width:h,height:i,dataItem:b}),l?p+=i:o+=h}}),t=d.extend({init:function(){d.fn.init.apply(this,arguments)},execute:function(l,i,k,d){var j,h,b,f,c,g,e=this;for(e.sort(l),j=e._squarifyCore(e._normalize(l,i.width*i.height,d),[],i,[]),h=e._getTreemap(j),g=0;g<h.length;g++)b=h[g],b.dataItem.items&&0!==b.dataItem.items.length?(f=d.createGroup(k,new a(b.left,b.top,b.right-b.left,b.bottom-b.top)),c=d.createTitle(f,d.getItemText(b.dataItem)),c=new a(c.left-f.position().left,c.top-f.position().top,c.width,c.height),e.execute(b.dataItem.items,c,f,d)):d.createItem(k,{left:b.left,top:b.top,width:b.right-b.left,height:b.bottom-b.top,dataItem:b.dataItem})},_squarifyCore:function(d,a,b,c){var g,f,h,e=this;return 0===d.length?void c.push(b.getRowContainers(a)):(g=b.getSize(),f=d[0],e._verifyRatio(a,f,g)?(a.push(f),e._squarifyCore(d.slice(1),a,b,c)):(h=b.remainingArea(e.sum(a)),c.push(b.getRowContainers(a)),e._squarifyCore(d,[],h,c)),c)},_getTreemap:function(c){var a,b,d=[];for(a=0;a<c.length;a++)for(b=0;b<c[a].length;b++)d.push(c[a][b]);return d},_verifyRatio:function(a,g,c){var b,d,e,f=this;return 0===a.length?!0:(b=a.slice(),b.push(g),d=f._calculateRatio(a,c),e=f._calculateRatio(b,c),d>=e)},_calculateRatio:function(a,c){var b=this,e=b.min(a),f=b.max(a),d=b.sum(a);return y(j(c,2)*f/j(d,2),j(d,2)/(j(c,2)*e))},_normalize:function(c,d,h){var a,e=this,f=e.sum(c),g=d/f,b=[];for(a=0;a<c.length;a++)b[a]=c[a],b[a].targetValue=b[a].targetValue*g;return b}}),v={cls:e,enabled:!0,width:e,height:e,title:e,dataSource:e,readDataSource:!0,type:"squarified",valueTemplate:"{value}",textTemplate:"{title}",colorTemplate:"{color}",colors:["#1E98E4","#FFC500","#5CB85C","#FF2A00","#6D31FF","#00B2A1","#FF8000","#84B3DC"],tooltip:{enabled:!1,template:"{title}: {value}",filter:".sui-treemap-item",delay:80,position:"top"},events:{}},o=l.extend({init:function(){l.fn.init.apply(this,arguments);var e,a=this,d=b(a.element),c=a.options,f=c.cls,g=c.dataSource,h=c.dieOnError;return"div"!==d.prop("tagName").toLowerCase()?void s("shieldTreeMap: Underlying element is not DIV.",h):(d.addClass("sui-treemap "+(f?" "+f:"")),k(c.width)&&d.css("width",c.width),k(c.height)&&d.css("height",c.height),g?(a.dataSource=A.create(g),a._eventNS=e=".shieldTreeMap"+a.getInstanceId(),a.containers=[],a.colorIndex=0,b(w).on("resize"+e,i(a._onWinResize,a)),a.dataSource.on("change"+e,i(a._dsChange,a)),c.readDataSource&&a.dataSource.read(),void a.enabled(c.enabled)):(a.destroy(),void s("shieldTreemap: dataSource is not defined.",h)))},_dsChange:function(){var a=this,b=a.element;a._create(),a._createTooltip(),a._elWidth=b.width(),a._elHeight=b.height()},_onWinResize:function(b){var a=this;a._onWinResTimeout&&clearTimeout(a._onWinResTimeout),a._onWinResTimeout=setTimeout(i(a._winResized,a),100)},_winResized:function(){var a=this,b=a.element;(a._elWidth!==b.width()||a._elHeight!==b.height())&&a.refresh()},_createTooltip:function(){var a=this,c=a.options.tooltip;c.enabled&&(a.tooltip?a.tooltip.refresh(c):a.tooltip=b(a.element).children(".sui-treemap-group").first().shieldTooltip(c).swidget())},_create:function(){var e,b=this,c=b.element,g=b.dataSource.data,h=b.options,i=d.create(h.type),f=new a(0,0,c.innerWidth(),c.innerHeight());c.empty(),b._prepareData(g),e=b.createGroup(c,f),f=b.createTitle(e,h.title),i.execute(g,f,e,b)},_prepareData:function(b){var a,c=this;for(a=0;a<b.length;a++)b[a].targetValue=c.getItemValue(b[a]),b[a].items&&c._prepareData(b[a].items)},createTitle:function(d,i){var g,j,k,l,m,n=this,h=n.options.type===f;return"undefined"===i||i===e?new a(d.position().left,d.position().top,d.innerWidth(),d.innerHeight()):(g=b('<div class="sui-treemap-title"></div>').appendTo(d),h&&g.innerHeight(d.outerHeight()),g.append('<div class="sui-treemap-title-inner">'+i.replace(/\s+/,"&nbsp;")+"</div>"),c.ui.Position.Set(g.find(".sui-treemap-title-inner"),g,{source:"center",target:"center"}),j=h?d.position().left+g.outerWidth():d.position().left,k=h?d.position().top:d.position().top+g.outerHeight(),l=h?d.innerWidth()-g.outerWidth():d.innerWidth(),m=h?d.innerHeight():d.innerHeight()-g.outerHeight(),new a(j,k,l,m))},createGroup:function(b,c){var a=this;return a._createContainer(b,c).addClass("sui-treemap-group sui-treemap-group-"+a.options.type)},createItem:function(g,b){var c,a=this,d=a.options,e=d.tooltip,j=(d.type===f,a.getItemText(b.dataItem));c=a._createContainer(g,b),c.addClass("sui-treemap-item").css("backgroundColor",a._getContentColor(b.dataItem)).on(p,i(a._contentClick,a,b.dataItem)),e.enabled&&c.attr("title",h(e.template,b.dataItem)),a.containers.push(c),c.html(j)},_contentClick:function(b){var a=this;a._enabled&&a.trigger(p,{title:a.getItemText(b),value:a.getItemValue(b),item:b})},_createContainer:function(c,a){return b("<div/>").appendTo(c).css({left:a.left,top:a.top,width:a.width,height:a.height})},_getContentColor:function(c){var a=this,b=a.options.colors;return a._getItemColor(c)||b[a.colorIndex++%b.length]},getItemValue:function(a){return z(h(this.options.valueTemplate,a))},getItemText:function(a){return h(this.options.textTemplate,a)},_getItemColor:function(b){var a=h(this.options.colorTemplate,b);return"undefined"!==a&&null!==a?a:e},enabled:function(){var c,a=this,d=b(a.element),e=[].slice.call(arguments);return e.length>0?(c=!!e[0],c?d.removeAttr(m).removeClass("sui-treemap-disabled"):d.attr(m,m).addClass("sui-treemap-disabled"),a.tooltip&&a.tooltip.enabled(c),a._enabled=c,void 0):a._enabled},destroy:function(){var c,a=this,d=a._eventNS;for(b(w).off(d),clearTimeout(a._onWinResTimeout),a._onWinResTimeout=null,a.dataSource&&a.dataSource.off(d),a.tooltip&&(a.tooltip.destroy(),a.tooltip=null),c=0;c<a.containers.length;c++)a.containers[c].off(p);a.containers=null,b(a.element).empty(),l.fn.destroy.call(a)}}),o.defaults=v,c.ui.plugin("TreeMap",o)}(jQuery,shield,this);